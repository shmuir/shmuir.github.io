{
  "hash": "d4e1b05debcd2e8e2b95b86dc7c009c7",
  "result": {
    "markdown": "---\ntitle: \"Predicting plant population trend from photosynthetic rate\"\nsubtitle: \"EDS222\"\nauthor: \"Sam Muir\"\ndate: \"December 12, 2023\"\noutput:\n  xaringan::moon_reader:\n    lib_dir: libs\n    nature:\n      highlightStyle: github\n      countIncrementalSlides: false\n    css: ['default', 'metropolis', 'metropolis-fonts', 'my-css.css']\n---\n\n---\n\n\n# Background\n\n#### Plants are threatened by many factors\n\n- Climate change\n- Habit loss\n- Human disturbance\n- Natural Disasters\n\n--\n\n#### Factors that make certain species more resiliant\n\n- Physiological traits/ Efficient metabolic processes\n- Associations with symbiotic oganisms\n\n--\n\n#### Endangered and Threatened Species\n\n- 764 plant species protected under the Endangered Species Act\n- 18,291 listed as having a decreasing population by The International Union for Conservation of Nature (IUCN)\n\n---\n\n\n# Question:\n\n## Can we predict if a plant species will have a decreasing population trend based on its photosynthetic rate and if it is threatened by climate change or human activity?\n\n---\n\n# Analysis Plan\n\n### Logistic Regression\n\n##### $$\\operatorname{logit}(p)=\\log \\left(\\frac{p}{1-p}\\right)=\\beta_0+\\beta_1  (Photosynthetic Rate) + \\beta_2  (Climate) + \\beta_3  (Human) +\\varepsilon $$\n\n### Odds Ratio\n\n##### $$\\operatorname{odds}(\\hat{p})=\\frac{\\hat{p}}{1-\\hat{p}}=\\exp \\left(\\hat{\\beta}_0+\\hat{\\beta}_1 \\cdot Photosynthetic Rate\\right)$$\n\n### Make Predictions ?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nthreat_prob <- function(b0, b1, b2, b3, photo, climate, human) {\n  equation <- b0 + b1 * photo + b2 * climate + b3 * human\n  prob <- (exp(equation)) / (1 + exp(equation))\n  print(prob)\n}\n```\n:::\n\n\n---\n\n# Data\n\n### Photosynthetic Rate\n- BIEN package in R\n  - Botanical Information and Ecology Network (BIEN) was developed by collaborating ecologists at the National Center for Ecological Analysis and Synthesis (NCEAS)\n\n### Population Trend and Threats\n- IUCN Red List\n  - Kingdom *Plantae*\n- Used search filters to select species threatened by climate or human activity  \n  \n---\n\n# Plotting the Data\n<small>\n\n::: {.cell}\n::: {.cell-output-display}\n![](plant-slides_files/figure-html/unnamed-chunk-2-1.png){width=3500}\n:::\n:::\n\n<small>\n\n---\n\n# Logistic Regression\n\n<small>$$\\operatorname{logit}(p)=\\log \\left(\\frac{p}{1-p}\\right)=\\beta_0+\\beta_1  (Photosynthetic Rate) + \\varepsilon$$<small>\n<small>\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](plant-slides_files/figure-html/unnamed-chunk-3-1.png){width=3500}\n:::\n:::\n\n<small>\n\n---\n\n# Logistic Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# model\nmod_photo <- glm(pop_trend_binary ~ avg_photo, \n                  data = join, \n                  family = \"binomial\") # binomial dist; prob of 1 and 0 over many trials\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Logisitc Regression Model Results for Photosynthetic Rate</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">log Probability of Decreasing Population</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Log-Odds</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.464 <sup>**</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.907&nbsp;&ndash;&nbsp;-0.016</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.041</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Avg. Photosynthetic Rate (Âµmol m-2 s-1)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.089 <sup>***</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.133&nbsp;&ndash;&nbsp;-0.048</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">609</td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-style:italic; border-top:double black; text-align:right;\">* p&lt;0.1&nbsp;&nbsp;&nbsp;** p&lt;0.05&nbsp;&nbsp;&nbsp;*** p&lt;0.01</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n$$\\operatorname{logit}(\\hat p)=\\log \\left(\\frac{\\hat p}{1-\\hat p}\\right)=-0.464-0.089 x$$\n\n---\n\n# Odds Ratio\n\nBy how much does the model predict that the odds of having a decreasing population will change with each additional unit in photosynthetic rate?\n\n$$\\operatorname{odds}(\\hat{p})=\\frac{\\hat{p}}{1-\\hat{p}}=\\exp \\left(\\hat{\\beta}_0+\\hat{\\beta}_1 \\cdot Photosynthetic Rate\\right)$$\n\n---\n\n# Odds Ratio\n<small>\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Logisitc Regression Model Results for Photosynthetic Rate</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">log Threat Pobability</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Log-Odds</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.464 <sup>**</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.907&nbsp;&ndash;&nbsp;-0.016</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.041</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Average Photosyntheitc Rate (Âµmol m-2 s-1)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.089 <sup>***</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.133&nbsp;&ndash;&nbsp;-0.048</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">609</td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-style:italic; border-top:double black; text-align:right;\">* p&lt;0.1&nbsp;&nbsp;&nbsp;** p&lt;0.05&nbsp;&nbsp;&nbsp;*** p&lt;0.01</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n<small>\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(mod_photo$coefficients[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\navg_photo \n0.9146572 \n```\n:::\n:::\n\n--\n#### The model estimates that one additional unit in photosynthetic rate is associated with a change in the odds ratio of $e^{-0.089} = 0.915$ or a 8.9% decrease in the odds of having a decreasing population.\n\n---\n\n# Odds Ratio\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](plant-slides_files/figure-html/unnamed-chunk-8-1.png){width=3500}\n:::\n:::\n\n\n---\n\n# Logistic Model\n\n<small>$$\\operatorname{logit}(p)=\\log \\left(\\frac{p}{1-p}\\right)=\\beta_0+\\beta_1  (Photosynthetic Rate) + \\beta_2  (Climate) + \\beta_3  (Human) +\\varepsilon$$<small>\n\n--\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n          (Intercept)             avg_photo climate_threatenedyes \n            0.6314813             0.8959289             4.2980568 \n  human_threatenedyes \n            2.5251016 \n```\n:::\n:::\n\n--\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Logisitc Regression Model Results for Photosynthetic Rate, Climate Threatened, and Human Threatened</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">log Threat Pobability</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Log-Odds</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.460 <sup>*</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.922&nbsp;&ndash;&nbsp;0.004</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.051</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Average Photosyntheitc Rate (Âµmol m-2 s-1)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.110 <sup>***</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.158&nbsp;&ndash;&nbsp;-0.065</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Climate Threatened</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.458 <sup>***</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.665&nbsp;&ndash;&nbsp;2.237</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Human Threatened</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.926 <sup></sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.299&nbsp;&ndash;&nbsp;2.210</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.145</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">609</td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-style:italic; border-top:double black; text-align:right;\">* p&lt;0.1&nbsp;&nbsp;&nbsp;** p&lt;0.05&nbsp;&nbsp;&nbsp;*** p&lt;0.01</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n---\n\n# Logistic Model\n\nBased on this model:\n\n- Plants threatened by climate factors have their odds of having a decreasing population increase by a factor of 4.29.\n- Plants threatened by human factors have their odds increase by a factor of 2.52.\n- The odds of having a decreasing population trend fall by about 10% for each unit increase in photosynthetic rate.\n\n---\n\n# Limitations and Next Steps\n\n- IUCN and BIEN do not have all plant species and the sample here might not be representative\n- Many species on the IUCN database have an unknown population trend status\n- Apply model to species with an unknown population status\n\n\n::: {.cell}\n\n```{.r .cell-code}\nthreat_prob <- function(b0, b1, b2, b3, photo, climate, human) {\n  equation <- b0 + b1 * photo + b2 * climate + b3 * human\n  prob <- (exp(equation)) / (1 + exp(equation))\n  print(prob)\n}\n```\n:::\n\n---\n# Thank you!\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](plant-pic.png){fig-align='center' width=40%}\n:::\n:::\n---",
    "supporting": [
      "plant-slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}