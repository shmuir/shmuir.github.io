{
  "hash": "ee0767ca918f3e007159e212f40b00e6",
  "result": {
    "markdown": "---\ntitle: \"The influence of photosynthetic rate and ecological threats on plant species population trends\"\ndescription: \"Predicting population trends for those with an unknown status\"\nauthor:\n  - name: Sam Muir\n    url: https://shmuir.github.io/\n  #  orcid: \n    affiliation: Bren School of Environmental Science & Management at University of California Santa Barbara\n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science\ndate: 12-15-2023\ncategories: [Plants, Climate, R, MEDS]\nbibliography: references.bib\ncitation:\n  url: https://shmuir.github.io/projects/2023-12-15-plant-population-prediction/\nimage: trees.jpeg\nformat:\n  html:\n    code-fold: true\n  pdf:\n    geometry: \n      - top=30mm\n      - left=30mm\n---\n\n\n\n\n\n\n\n# Project Overview\n\n## Motivation\n\nClimate change and human activity are significant contributors to habitat loss, and therefore threaten many plant populations. Nearly 40% of plant species are threatened worldwide, and even more are predicted to become threatened as effects of climate change and human activity continue [@IUCN2023]. Many plant species that are threatened or endangered are not very resilient to conditions outside of their niche, often due to their physiological traits, such as carbon fixation or drought tolerance [@bhadra2022a].\n\nC4 and CAM plants have a more efficient carbon fixation process and are generally more photosynthetically-efficient than C3 processes [@nobel1991]. Plants with high photosynthetic efficiency are often economically important as crops and more resilient to harsh environments due to their energy conservation [@simkin2019].\n\n![Made with BioRender.com](photosynth.png){fig-align=\"left\" width=\"500\"} ![](space.png){width=\"85\" height=\"50\"}![Bhadra et al. 2022](climate-threats.jpg){fig-align=\"right\" width=\"194\"}\n\n[Made with BioRender]{style=\"color: grey;\"}                            [@bhadra2022a]\n\nUnderstanding the drivers of plant population decline by specie can help inform on conservation priority, though it is good to keep in mind that not all plants with a decreasing population trend are classified as threatened. Some may have a decreasing population due to effective management of invasive and destructive species [@byun2017].\n\n## Question\n\nThere are many other factors that affect a species' population trend, but in this project, I am interested in analyzing how a plant species photosynthetic rate and ecological threats influence a species' odds of having a decreasing population. Additionally, can I use this model to find the log-odds of a plant with an unknown status having a decreasing population trend?\n\n# Data & Methods\n\nPhotosynthetic rate data was obtained from the `BIEN` R package [@BIEN]. The [Botanical Information and Ecology Network (BIEN)](https://bien.nceas.ucsb.edu/bien/) was developed by collaborating ecologists at the [National Center for Ecological Analysis and Synthesis (NCEAS)](https://www.nceas.ucsb.edu/). The BIEN database contains a variety of information ranging from phylogeny data to species distribution. To determine population trend and if a species is threatened by climate change or human activity I obtained data from the [International Union for Conservation Nature (IUCN) Red List](https://www.iucnredlist.org/). Climate threats include habitat shifts, droughts, temperature extremes, storms & flooding, and \"other impacts\" that are not defined by the IUCN. Human threats include housing & urban areas, commercial & industrial areas, tourism & recreation areas, recreational activities, war & civil unrest, and work & other activities [@rredlist].\n\nTo analyze my data I ran a logistic regression model. I used Increasing/Stable (0) and Decreasing (1) as the categorical binary response variable on average photosynthetic rate per leaf area, climate threatened (yes/no), and human threatened (yes/no).\n\n## Data Preparation\n\nData was prepared in a separate `data_fetch.R` script. Data from `BIEN` was cleaned and joined with data from the IUCN Red List entries for species in the kingdom *Plantae*. Species that had an increasing or stable population trend were assigned a binary variable of 0 and those who had a decreasing population trend were assigned a binary variable of 1.\n\n``` r\nsource(file.path(\"data_fetch.R\")) \n```\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Data Exploration\n\nBefore starting any statistical analysis, we should take a look at the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(join, aes(x = avg_photo)) +\n  geom_histogram(fill = \"#94a699\", color = \"black\") +\n  theme_linedraw() +\n  labs(x = \"Avg. Photosynthetic Rate per Leaf Area (Âµmol m-2 s-1)\",\n       title = \"Distribution of photosynthetic rate\") +\n  theme(plot.background = element_rect(color = \"#FDFBF7\",\n                                       fill = \"#FDFBF7\"),\n        panel.background = element_rect(fill = \"#FDFBF7\"))\n```\n\n::: {.cell-output-display}\n![](UntitledRMD_files/figure-pdf/unnamed-chunk-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = join, aes(x = avg_photo, y = pop_trend)) + \n  geom_jitter(width = 0, height = 0.05, alpha = 0.7, color = \"#94a699\") +\n  theme_linedraw() +\n  scale_y_discrete(limits = c(\"Stable_Inc\", \"Decreasing\")) +\n  labs(x = \"Avg. Photosynthetic Rate per Leaf Area (Âµmol m-2 s-1)\", \n       y = \"Population Trend\", \n       title = \"\") +\n  theme(plot.background = element_rect(color = \"#FDFBF7\",\n                                       fill = \"#FDFBF7\"),\n        panel.background = element_rect(fill = \"#FDFBF7\"))\n```\n\n::: {.cell-output-display}\n![](UntitledRMD_files/figure-pdf/unnamed-chunk-3-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclim_plot <- ggplot(clim_human_res, aes(x = climate_threatened)) +\n  geom_bar(width = 0.5, fill = \"#94a699\", color = \"black\") +\n  theme_linedraw() +\n  labs(x = \"Climate threatened?\") +\n  theme(plot.background = element_rect(color = \"#FDFBF7\",\n                                       fill = \"#FDFBF7\"),\n        panel.background = element_rect(fill = \"#FDFBF7\"))\n\nhuman_plot <- ggplot(clim_human_res, aes(x = human_threatened)) +\n  geom_bar(width = 0.5, fill = \"#94a699\", color = \"black\") +\n  theme_linedraw() +\n  labs(x = \"Human threatened?\", y = \"\") +\n  theme(plot.background = element_rect(color = \"#FDFBF7\",\n                                       fill = \"#FDFBF7\"),\n        panel.background = element_rect(fill = \"#FDFBF7\"))\n\nclim_plot + human_plot + plot_annotation(theme = theme(plot.background = element_rect(color = \"#FDFBF7\",\n                                       fill = \"#FDFBF7\")),\n                                       title = \"Counts for climate threatened and human threated species\")\n```\n\n::: {.cell-output-display}\n![](UntitledRMD_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n# Analysis\n\n## Logistic Regression\n\nTo begin, I want to run a logistic regression on just photosynthetic rate and population trend before incorporating any other variables.\n\n$$\n\\operatorname{logit}(p)=\\log \\left(\\frac{p}{1-p}\\right)=\\beta_0+\\beta_1  (Photosynthetic Rate)  +\\varepsilon \n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# binary resp glm plot\nggplot(join, aes(x = avg_photo, y = pop_trend_binary)) + \n  geom_jitter(width = 0, height = 0.05, alpha = 0.8, color = \"#94a699\") +\n  geom_smooth(method = \"glm\", se = FALSE, color = \"#223a2b\", \n              method.args = list(family = \"binomial\"),\n              size = 1.5) +\n  theme_linedraw() +\n  labs(x = \"Avg. Photosynthetic Rate per Leaf Area (Âµmol m-2 s-1)\", \n       y = \"Has Decreasing Population Trend\") +\n  theme(plot.background = element_rect(color = \"#FDFBF7\",\n                                       fill = \"#FDFBF7\"),\n        panel.background = element_rect(fill = \"#FDFBF7\"))\n```\n\n::: {.cell-output-display}\n![](UntitledRMD_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# model\nmod_photo <- glm(pop_trend_binary ~ avg_photo, \n                  data = join, \n                  family = \"binomial\") # binomial dist; prob of 1 and 0 over many trials\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Logisitc Regression Model Results for Photosynthetic Rate</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">log Probability of Decreasing Population</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Log-Odds</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.464 <sup>**</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.907&nbsp;&ndash;&nbsp;-0.016</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.041</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Avg. Photosynthetic Rate (Âµmol m-2 s-1)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.089 <sup>***</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.133&nbsp;&ndash;&nbsp;-0.048</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">609</td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-style:italic; border-top:double black; text-align:right;\">* p&lt;0.1&nbsp;&nbsp;&nbsp;** p&lt;0.05&nbsp;&nbsp;&nbsp;*** p&lt;0.01</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\nThis model tells us:\n\nA 1 Âµmol m-2 s-1 increase indicates a 0.089 decrease in probability of having a decreasing population trend.\n\n$$\n\\operatorname{logit}(\\hat p)=\\log \\left(\\frac{\\hat p}{1-\\hat p}\\right)=-0.464-0.089 x\n$$\n\n### Odds Ratio\n\nBy how much does the model predict that the odds of having a decreasing population will change with each additional unit in photosynthetic rate?\n\n$$\n\\operatorname{odds}(\\hat{p})=\\frac{\\hat{p}}{1-\\hat{p}}=\\exp \\left(\\hat{\\beta}_0+\\hat{\\beta}_1 \\cdot Photosynthetic Rate\\right)\n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(mod_photo$coefficients[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\navg_photo \n0.9146572 \n```\n:::\n:::\n\n\n\nThe model estimates that one additional unit in photosynthetic rate is associated with a change in the odds ratio of $e^{-0.089} = 0.915$, or a 8.9% decrease in the odds of having a decreasing population.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# compute odds hat var\nphoto_fitted <- mod_photo %>%\n  augment(type.predict = \"response\") %>%\n  mutate(y_hat = .fitted) %>%\n  mutate(odds_hat = y_hat / (1 - y_hat)) # y_hat is p\n\n# plot\nggplot(photo_fitted, aes(x = avg_photo, y = odds_hat)) +\n  geom_point(size = 2.5, color = \"#94a699\", alpha = 0.7) +\n  geom_line(color = \"#223a2b\") + \n  scale_y_continuous(\"Log-odds of having a decreasing population\") +\n  labs(x = \"Avg. Photosynthetic Rate (Âµmol m-2 s-1)\") +\n  theme_linedraw() +\n  theme(plot.background = element_rect(color = \"#FDFBF7\",\n                                       fill = \"#FDFBF7\"),\n        panel.background = element_rect(fill = \"#FDFBF7\"))\n```\n\n::: {.cell-output-display}\n![](UntitledRMD_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nAdditionally, we can visually see this relationship between the odds ratio and photosynthetic rate. As photosynthetic rate increases, the log-odds of having a decreasing population decreases.\n\n## Full Logistic Model\n\nThis first logistic model only considered photosynthetic rate, but now we want to add in if the species is threatened by climate change or human activity, since both of these historically have contributed to plant species becoming threatened.\n\n$$\\operatorname{logit}(p)=\\log \\left(\\frac{p}{1-p}\\right)=\\beta_0+\\beta_1  (Photosynthetic Rate) + \\beta_2  (Climate) + \\beta_3  (Human) +\\varepsilon $$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- glm(pop_trend_binary ~ avg_photo + climate_threatened + human_threatened,\n           data = clim_human_res,\n           family = \"binomial\")\n\nexp(coef(mod))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          (Intercept)             avg_photo climate_threatenedyes \n            0.6314813             0.8959289             4.2980568 \n  human_threatenedyes \n            2.5251016 \n```\n:::\n\n```{.r .cell-code}\nmod$coefficients[2] # B1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n avg_photo \n-0.1098942 \n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Logisitc Regression Model Results for Photosynthetic Rate, Climate Threatened, and Human Threatened</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">log Threat Pobability</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Log-Odds</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.460 <sup>*</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.922&nbsp;&ndash;&nbsp;0.004</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.051</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Average Photosyntheitc Rate (Âµmol m-2 s-1)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.110 <sup>***</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.158&nbsp;&ndash;&nbsp;-0.065</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Climate Threatened</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.458 <sup>***</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.665&nbsp;&ndash;&nbsp;2.237</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Human Threatened</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.926 <sup></sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.299&nbsp;&ndash;&nbsp;2.210</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.145</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">609</td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-style:italic; border-top:double black; text-align:right;\">* p&lt;0.1&nbsp;&nbsp;&nbsp;** p&lt;0.05&nbsp;&nbsp;&nbsp;*** p&lt;0.01</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\nFrom this model we can conclude that plants threatened by climate factors have their odds of having a decreasing population increase by a factor of 4.29, while those threatened by human factors have their odds increase by a factor of 2.52.\n\nWe can also see that photosynthetic rate does still have an effect on population trend. Based on this model, the odds of having a decreasing population trend fall by about 11% for each unit increase in photosynthetic rate.\n\n# Assessing Model Performance\n\nNow that we have this model, I am interested in assessing the accuracy of it, which can be done by creating a confusion matrix. This is a very simple version of a confusion matrix where I have set log-odds values of ≥0.5 to classify the species as 1 (has a decreasing population) and values \\<0.5 to 0 (has a non-decreasing population). I can then compare these predicted values to the actual population trend for the species and calculate the false-positive and false-negative rates.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphoto_plus <- augment(mod, type.predict = \"response\") %>%\n  mutate(y_hat = round(.fitted)) %>%\n  select(pop_trend_binary, avg_photo, .fitted, y_hat)\ncon_matrix <- photo_plus %>%\n  select(pop_trend_binary, y_hat) %>%\n  table()\nrownames <- c(\"Actually has Non-Decreasing Pop.\", \"Actually has Decreasing Pop.\")\ncolnames <- c(\"Predicted Non-Decreasing Pop.\", \"Predicted Decreasing Pop.\")\ncon_matrix <- as.data.frame(matrix(c(con_matrix[1], \n                                       con_matrix[2], \n                                       con_matrix[3], \n                                       con_matrix[4]), \n                                     ncol = 2, \n                                     nrow = 2),\n                              row.names = rownames)\ncolnames(con_matrix) <- colnames\n\nwhere <- rbind(c(2,1), c(2,2), c(1,1), c(1,2))\nstyle <- c('color: red;',\n           'color: green;',\n           'color: green;',\n           'color: red;')\n\ncss.cell <- matrix('', nrow(con_matrix), ncol(con_matrix))\ncss.cell[where] <- style\n\nhtmlTable::htmlTable(con_matrix, css.cell = css.cell,\n                     caption = \"Confusion Matrix to Assess Photosynthetic Rate Model Performance\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >\n<thead>\n<tr><td colspan='3' style='text-align: left;'>\nConfusion Matrix to Assess Photosynthetic Rate Model Performance</td></tr>\n<tr><th style='border-bottom: 1px solid grey; border-top: 2px solid grey;'></th>\n<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Predicted Non-Decreasing Pop.</th>\n<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Predicted Decreasing Pop.</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style='text-align: left;'>Actually has Non-Decreasing Pop.</td>\n<td style='color: green; text-align: center;'>477</td>\n<td style='color: red; text-align: center;'>8</td>\n</tr>\n<tr>\n<td style='border-bottom: 2px solid grey; text-align: left;'>Actually has Decreasing Pop.</td>\n<td style='color: red; border-bottom: 2px solid grey; text-align: center;'>112</td>\n<td style='color: green; border-bottom: 2px solid grey; text-align: center;'>12</td>\n</tr>\n</tbody>\n</table>\n`````\n:::\n:::\n\n\n\nFrom this confusion matrix we can see True Positive/True Negative values in green and False Positive/False Negative values in red. Based on these counts, the model has an 80% accuracy. The model seems to be better at predicting if a specie has a non-decreasing population rather than if it has a decreasing population.\n\nAbove 90% accuracy seems to be standard for industry implementation [@towardsdatascience2020], but for the purpose of this project, I still want to use my model to try to make population trend predictions for other species not in my data.\n\n# Making Probabilistic Predictions\n\nThere are many species from the BIEN data that are not present on the IUCN Red List. Here, I am using my model to make out-of-sample predictions. To do this, I'll need to pull out the model coefficients and create a function with inputs for the coefficients, photosynthetic rate, and if the plant is threatened by climate change.\n\n``` r\n# coefficients\nb0 <- mod$coefficients[1] #Intercept\nb1 <- mod$coefficients[2] #photo\nb2 <- mod$coefficients[3] #climate\nb3 <- mod$coefficients[4] #human\n\n# function\nthreat_prob <- function(b0, b1, b2, b3, photosyntheitc_rate, climate, human) {\n  equation <- b0 + b1 * photosyntheitc_rate + b2 * climate + b3 * human\n  prob <- (exp(equation)) / (1 + exp(equation))\n  print(prob)\n}\n```\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\n\\caption{\\label{tab:unnamed-chunk-15}Predicted log-odds of being threatened (ˆy) for species with an unknown population trend}\n\\centering\n\\begin{tabu} to \\linewidth {>{\\raggedright}X>{\\raggedleft}X>{\\raggedleft}X>{\\raggedleft}X>{\\raggedleft}X}\n\\toprule\nSpeices & Photosynthetic Rate & Climate & Human & ˆy\\\\\n\\midrule\n\\cellcolor{gray!6}{Psammochloa villosa} & \\cellcolor{gray!6}{65.05000} & \\cellcolor{gray!6}{0} & \\cellcolor{gray!6}{0} & \\cellcolor{gray!6}{0.0004961}\\\\\nHelianthus neglectus & 48.72300 & 0 & 0 & 0.0029764\\\\\n\\cellcolor{gray!6}{Helianthus niveus} & \\cellcolor{gray!6}{46.74867} & \\cellcolor{gray!6}{1} & \\cellcolor{gray!6}{0} & \\cellcolor{gray!6}{0.0156898}\\\\\nGlaux maritima & 43.00000 & 1 & 1 & 0.0572868\\\\\n\\cellcolor{gray!6}{Helianthus cusickii} & \\cellcolor{gray!6}{42.24100} & \\cellcolor{gray!6}{0} & \\cellcolor{gray!6}{0} & \\cellcolor{gray!6}{0.0060494}\\\\\nGouania lupuloides & 0.70820 & 1 & 0 & 0.7151743\\\\\n\\cellcolor{gray!6}{Serjania mexicana} & \\cellcolor{gray!6}{0.68560} & \\cellcolor{gray!6}{0} & \\cellcolor{gray!6}{1} & \\cellcolor{gray!6}{0.5965838}\\\\\nClematis florida & 0.61000 & 1 & 0 & 0.7173674\\\\\n\\cellcolor{gray!6}{Passiflora vitifolia} & \\cellcolor{gray!6}{0.51340} & \\cellcolor{gray!6}{1} & \\cellcolor{gray!6}{1} & \\cellcolor{gray!6}{0.8662658}\\\\\nCissus erosa & 0.43180 & 0 & 0 & 0.3758644\\\\\n\\bottomrule\n\\end{tabu}\n\\end{table}\n:::\n:::\n\n\n\nThese are the log-odds predictions for the species with the 5 highest and 5 lowest photosynthetic rates.\n\n![](psammochloa.jpeg){width=\"200\"}![](space.png){width=\"380\"}![](cissus.jpeg){width=\"224\"}\n\n*Psammochloa villosa*                            *Cissus erosa*\n\n# Thoughts and Conclusions\n\nOverall, this model suggests that photosynthetic rate per leaf area has a strong effect on if a plant will have a decreasing population trend. Those threatened by climate change and human factors are also more likely to have a decreasing population trend. The results of this logistic model and odds ratio generally align with what I expected to see. Though, I did think that human factors would have more of a significant impact There are also many other factors that this model is not including, but another big contribution to habitat loss is agriculture, which would be interesting to incorporate in the model.\n\nThis model may also be biased due to the relatively small sample size of plant species. There were many observations that were filtered out during data preparation since each species needed to be present in the BIEN and IUCN data sets. Given a larger sample, the model could be more accurate. Additionally, I would like to construct a more sophisticated confusion matrix using the `caret` package and split my data into training and testing sets.\n\nWith a more comprehensive data set and controlling for more variables (additional threats), this model could be useful in flagging species that have high odds of having a decreasing population trend, if they currently have an unknown status. As I mentioned in the motivation for this project, not all plants with a decreasing population trend are threatened, so it would also be interested to create a similar model using photosynthetic rate and conservation status.\n\nTo see the full code and data preparation, check out the [Github repository](https://github.com/shmuir/plant-pop-pred).\n",
    "supporting": [
      "UntitledRMD_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{longtable}\n\\usepackage{array}\n\\usepackage{multirow}\n\\usepackage{wrapfig}\n\\usepackage{float}\n\\usepackage{colortbl}\n\\usepackage{pdflscape}\n\\usepackage{tabu}\n\\usepackage{threeparttable}\n\\usepackage{threeparttablex}\n\\usepackage[normalem]{ulem}\n\\usepackage{makecell}\n\\usepackage{xcolor}\n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}